---
import Badge from './Badge.astro';
import { Picture } from '@astrojs/image/components';
import { blogImage } from '../util/images';
// import { GetImageTransform } from '@astrojs/image/dist/lib/get-image';

export interface Props {
	title: string;
	description: string;
	publishDate: string;
	url: string;
	author: string;
	heroImage?: {
		src: string;
		alt: string;
	};
	category: 'dev' | 'exploit' | 'misc' | 'release';
}

const { title, description, publishDate, url, author, heroImage, category } = Astro.props as Props;

const img = await blogImage(heroImage.src);
---

<div>
	<a href={url}>
		<article class="card rounded-lg sm:max-h-[270px] sm:card-side bg-lm-faded dark:bg-dm-faded shadow-xl transition-colors duration-200">
			{img && (
				<div class="m-4 rounded-lg overflow-hidden shrink-0">
					<figure class="max-w-sm">
						<Picture src={img} alt={'test'} aspectRatio={16 / 9} widths={[200, 400, 800]} sizes="(max-width: 800px) 100vw, 800px" />
					</figure>
				</div>
			)}
			<div class="card-body p-5">
				<div class="flex items-center space-x-2">
					<Badge type={category} size={'small'} />
					<time class="text-xs text-lm-body dark:text-dm-body">{publishDate}</time>
				</div>
				<h2 class="mt-3 card-title text-[32px] text-lm-heading dark:text-dm-heading">{title}</h2>
				<p class="mt-2 text-md lg:line-clamp-3 line-clamp-2 flex-grow-0 text-lm-body dark:text-dm-body">{description}</p>
				<div class="mt-auto flex items-center">
					<div class="avatar mr-3">
						<div class="w-8 rounded-full">
							<!-- <img src={image} /> -->
						</div>
					</div>
					<div>
						<span class="text-sm text-lm-body dark:text-dm-body">{author}</span>
					</div>
				</div>
			</div>
		</article>
	</a>
</div>
